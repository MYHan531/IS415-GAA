---
title: "Take-Home Exercise 2: Geospatial Analytics for Social Good - Thailand Drug Abuse Case Study"
title-block-banner: true
author: "Your Name"
date: 2024-10-08
date-modified: "last-modified"
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: right
    number-sections: true
    number-depth: 3
    code-copy: true
    embed-resources: true
    lightbox: true
    lang: en
abstract: |
  In this exercise, we apply geospatial analysis techniques to study the distribution of drug use cases in Thailand at the provincial level from 2017 to 2022. By leveraging global and local spatial autocorrelation methods, we aim to uncover patterns, detect clusters and hotspots, and investigate how these trends evolve over time.
keywords: ["Geospatial Analysis", "Drug Abuse", "Spatial Autocorrelation", "Thailand", "Clusters", "Hotspots"]
---

## Introduction

In this analysis, we explore the spatial distribution of drug use in Thailand from 2017 to 2022 using geospatial data and analysis methods. Drug abuse remains a significant social issue, particularly among youth, with the number of users continuing to rise. This exercise leverages geographic information system (GIS) tools to explore how drug use patterns are distributed across Thailand's provinces and whether spatial dependencies exist in these patterns.

Thailand’s geopolitical position near the Golden Triangle, a major drug-producing region, further complicates its drug abuse situation. This study aims to identify spatial correlations, clusters, outliers, and hotspots in drug use cases over time.

# **Overview**

This take-home exercise focuses on the application of geospatial analysis methods to explore and analyze the spatial distribution of drug abuse in Thailand at the provincial level from 2017 to 2022. We aim to detect spatial clusters, outliers, and hotspots, while also assessing how these trends evolve over time. By leveraging global and local spatial autocorrelation methods, we aim to uncover key patterns in the distribution of drug use cases in Thailand.

## **Data used**

For this study, two main data sources were utilized: - **Thailand Drug Offenses (2017-2022)**, sourced from [Kaggle](https://www.kaggle.com/datasets) - **Thailand Subnational Administrative Boundaries**, sourced from [HDX](https://data.humdata.org/dataset)

These datasets provided the necessary drug abuse indicators at the provincial level and the geographical boundaries required for the spatial analysis.

Tools used: - **sf**: for managing and manipulating geospatial data. - **tidyverse**: for general data wrangling and visualization. - **sfdep**: for performing spatial autocorrelation analysis.

::: panel-tabset
## The Task

The tasks for this take-home exercise are as follows:

1.  **Data Preparation**:
    -   Using functions from **sf** and **tidyverse**, import the Thailand drug abuse data and administrative boundary data.
    -   Create a spatial layer for Thailand provinces and a drug abuse indicators layer.
2.  **Global Spatial Autocorrelation**:
    -   Perform global spatial autocorrelation using Moran’s I to assess if drug abuse patterns are spatially random or dependent.
3.  **Local Spatial Autocorrelation**:
    -   Perform local spatial autocorrelation to detect spatial clusters, outliers, and hotspots using Local Moran’s I.
4.  **Visualizing Spatial Patterns**:
    -   Use appropriate **ggplot2** and **tmap** functions to visualize the spatial patterns of drug use cases over time.
5.  **Describe Findings**:
    -   Describe the spatial patterns revealed by the analysis and how these patterns evolved from 2017 to 2022.

## Grading Criteria

1.  **Geospatial Data Wrangling (20 marks)**:
    -   You will be evaluated based on your ability to use R functions to import, clean, and prepare the geospatial data.
2.  **Spatial Analysis (30 marks)**:
    -   This includes performing the global and local spatial autocorrelation analyses and deriving insights from the patterns.
3.  **Geovisualization (20 marks)**:
    -   Your ability to effectively communicate the analysis results through visualizations will be assessed.
4.  **Reproducibility (15 marks)**:
    -   The exercise must be well-documented, and the code should be clear and easy to follow.
5.  **Bonus (15 marks)**:
    -   Demonstrate any advanced methods beyond what was covered in class.
:::

## **Installing and Loading the R Packages**

Before proceeding with the analysis, it is essential to install and load the required R packages:

```{r}
# Install and load necessary packages
pacman::p_load(sf, tidyverse, sfdep, tmap, readr, ggplot2)
```

## **Importing and Transforming the Data**

First, we will import the administrative boundary data for Thailand and the drug abuse dataset.

```{r}
# Load the province boundary data (sf object)
provinces_sf <- st_read("path_to_boundary_file.shp")

# Load the drug abuse data
drug_data <- read_csv("path_to_drug_data.csv")

# Display the structure of the datasets
glimpse(provinces_sf)
glimpse(drug_data)
```

## **Spatial Data Wrangling**

Next, we merge the drug abuse data with the spatial dataset for Thailand provinces to prepare it for analysis.

```{r}
# Merge drug data with province boundaries
drug_abuse_sf <- left_join(provinces_sf, drug_data, by = "province_id")

# Check the merged data
glimpse(drug_abuse_sf)

```

## **Global Spatial Autocorrelation (Moran's I)**

Now, we calculate Moran's I to detect whether the spatial distribution of drug use cases is random or exhibits spatial clustering.

```{r}
# Perform global spatial autocorrelation using Moran's I
global_moran <- calculate_moran(drug_abuse_sf)
print(global_moran)

```

## **Local Spatial Autocorrelation (Local Moran’s I)**

Next, we perform local spatial autocorrelation to detect clusters and hotspots using Local Moran's I.

```{r}
# Perform local spatial autocorrelation using Local Moran's I
local_moran <- calculate_local_moran(drug_abuse_sf)
plot(local_moran)

```

## **Results**

### **Global Moran’s I**

The results from the global spatial autocorrelation analysis indicate that drug abuse in Thailand shows a statistically significant clustering pattern, as indicated by a positive Moran’s I value.

```{r}
# Plot results of Moran's I
ggplot(drug_abuse_sf) + 
  geom_sf(aes(fill = global_moran)) + 
  labs(title = "Global Moran's I for Drug Abuse Cases (2017-2022)")

```

### **Local Moran’s I**

The local spatial autocorrelation analysis revealed significant clusters and hotspots in specific provinces, particularly in the northern regions, near the Golden Triangle.

```{r}
# Plot the spatial distribution of Local Moran's I results
ggplot(drug_abuse_sf) + 
  geom_sf(aes(fill = local_moran)) + 
  labs(title = "Local Moran's I - Drug Abuse Hotspots (2017-2022)")

```

## **Discussion**

From the analysis, it is clear that drug abuse cases in Thailand are not randomly distributed but tend to cluster in specific regions. The clusters are primarily concentrated in the northern provinces, likely influenced by the country's proximity to the Golden Triangle, a major drug production site.

Over time, the analysis shows that hotspots in drug use have shifted slightly but remain concentrated around key transportation routes, indicating potential trafficking patterns.

## **Conclusion**

This geospatial analysis highlights the non-random, clustered nature of drug abuse cases across Thailand. The application of global and local spatial autocorrelation methods provides insight into the spatial dynamics of the drug problem, with certain provinces consistently exhibiting high drug use levels. These findings have important implications for law enforcement and public health interventions.

## **References**

1.  **Thailand Drug Offenses (2017-2022)**: Kaggle Dataset

2.  **Thailand Subnational Administrative Boundaries**: HDX Dataset

3.  **World Drug Report 2023**: UNODC Report

4.  Khan, D. et al. (2017). *Hot spots, cluster detection and spatial outlier analysis of teen birth rates in the U.S., 2003–2012*. *Spatial and Spatio-temporal Epidemiology*.

5.  **R Packages**:

    -   **sf**, **tidyverse**, **sfdep**: Spatial data handling and geospatial analysis.

    -   **ggplot2**, **tmap**: Data visualization.
